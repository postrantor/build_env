---
date: 2024-10-12 00:30:02
date: 2024-11-14 03:09:20
date: 2025-01-31 10:03:28
---

## quadruped

### 阶段性目标

- [ ] 使用现有代码调试一组电机
- [ ] 使用现有工程调试机器人结构

### 下一步需要完善的

- [x] 阅读 MPC 算法代码
- [x] 完善 quadruped 的 log 输出，用于调试
  - [x] 已将部分 roslog 替换为标准 spdlog，需要进一步替换
  - [x] 逐步完善 log 输出，用于定位调试
- [x] gazebo 仿真中初始化机器人的位姿存在问题
- [x] 支持 IMU 传感器反馈

- [ ] 关于 unitree 电机混合控制（力位控制）的使用，联合 kp/kd 的设置问题，需要修改 unitree_joint_controller 层在设置 q/dq/tau 数值时的计算，修改代码量小，但是需要配合电机将控制效果调优

- [ ] 通过对上述问题的理解，在 gazebo 中是可以仿真混合控制模式的，但是在实际仿真中发现 dq 的值一直是零，需要追到控制算法中查看，虽然仿真中可以运行，但是实际电机力矩曲线不平滑，需要调试；不涉及到代码大量修改，但是得调试测试，已经进行了

  - 参考一下文档的分析：[](quadruped/test/controllers/qr_swing_leg_controller.md)
  - 梳理清楚对于 dq/ddq 数值计算是依赖具体的插值算法，在选用插值算法时候依据步态及相位决定
  - 在小步运动状态下仅有 q 及 tau 的值，还需要进一步分析

- [ ] 整体对 ros2 control 每层逻辑的参数配置优化，需要考虑到位，限位值的设置，代码量修改小
- [ ] 原算法逻辑中存在大量预设值，需要针对指定机器人进行适配，这个放在其次，之后修改成通过配置文件设定，开发优先级低
- [ ] 适配实体样机 urdf 模型参数，工作量小

- [ ] 当使用真实机器人的时候，应该屏蔽 gazebo 相关的内容

### 在开发中逐步完善的

- [x] 修正所有 new 关键字，替换为 shared_ptr/unique_ptr
- [x] double -> float 的窄类型转换问题，以及其他类型问题
  - [x] 修复在 exmaple_gazebo 中错误使用 float 与 double 类型数值比较导致的问题
  - [ ] 还有部分遗留，在后续开发中修正
- [ ] quadruped 中对计算频率为 1000Hz 等数值 存在较多的硬编码

### 需要较多修改的，在开发中逐步完善的

- [x] 修改 example_gazebo 中控制循环的方式，修改为 timer 定时调度
- [ ] 重构项目使用的配置文件参数传递的方式
- [ ] gazebo plugin 插件移植至 ROS2

## other

- [ ] 考虑使用 RED 框架？
- [ ] 支持 MATLAB 联合仿真？
